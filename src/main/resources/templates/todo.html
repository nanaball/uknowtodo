<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="/css/material.min.css">
  <link rel="stylesheet" href="/css/todo.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <title>U Know To do</title>
</head>
<body>
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
  <header th:replace="~{/layout/header :: header}"></header>
  <main class="mdl-layout__content">
    <div class="mdl-grid">
      <div class="mdl-cell mdl-cell--10-col mdl-cell--1-offset">
        <h1 class="mdl-typography--display-1">안녕하세요, <span sec:authentication="principal.name"></span> 님!</h1>
        <div class="todo-content-input">
          <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" type="text" id="sample6">
            <label class="mdl-textfield__label" for="sample6"></label>
          </div>
          <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" type="date">
            <label class="mdl-button mdl-js-button mdl-button--fab mdl-button--primary mdl-button--colored"
                   for="sample6">
              <i class="material-icons">add</i>
            </label>
          </div>
        </div>
      </div>
    </div>
    <div class="mdl-grid">
      <div class="mdl-cell mdl-cell--10-col mdl-cell--1-offset-desktop">
        <div th:text="'총 '+${content.totalElements} + 개"></div>
        <ul class="mdl-list todo-list" th:with="todoList=${content.content}">
          <li th:each="todo: ${todoList}"
              th:data-no="${todo.todoNo}"
              class="mdl-list__item todo-list-item">
            <span>
              <label class="mdl-checkbox todo-checkbox mdl-js-checkbox mdl-js-ripple-effect"
                     th:for="'todo-checkbox-' + ${todo.todoNo}">
                <input type="checkbox" th:id="'todo-checkbox-' + ${todo.todoNo}" class="mdl-checkbox__input"
                       th:checked="${todo.completed}"/>
              </label>
            </span>
            <span class="todo-list-item__content">
              <span class="todo-list-item__title">
                <span class="todo-list-item__title-text" th:text="${todo.todoName}"></span>
                <span class="mdl-textfield mdl-js-textfield todo-list-item__title-input">
                  <input class="mdl-textfield__input" type="text"
                         th:value="${todo.todoName}"
                         th:id="'todo-title-input-' + ${todo.todoNo}">
                  <label class="mdl-textfield__label" th:for="'todo-title-input-' + ${todo.todoNo}"></label>
                </span>
                <span class="todo-edited-info">수정중</span>
                <span class="todo-list-item__info">
                  <span th:id="'todo-info-'+${todo.todoNo}"
                        class="material-icons md-18 mdl-color-text--indigo-A700">info_outlined</span>
                  <span class="mdl-tooltip"
                        th:for="'todo-info-'+${todo.todoNo}">
                    생성일자: [[${todo.createdDate}]]<br />
                    수정일자: [[${todo.updatedDate}]]
                  </span>
                </span>
              </span>
              <span class="todo-list-item__content-row">
                <button class="mdl-chip mdl-color--primary mdl-color-text--white">
                  <span class="mdl-chip__text">메모 추가</span>
                </button>
                <button class="mdl-chip mdl-color--primary mdl-color-text--white">
                  <span class="mdl-chip__text">날짜 추가</span>
                </button>
                <span class="todo-list-item__content" th:text="${todo.todoContent}"></span>
                <span class="mdl-textfield mdl-js-textfield todo-list-item__content-input">
                  <input class="mdl-textfield__input" type="text"
                         th:value="${todo.todoContent}"
                         th:id="'todo-content-input-' + ${todo.todoNo}">
                  <label class="mdl-textfield__label" th:for="'todo-content-input-' + ${todo.todoNo}">메모</label>
                </span>
              </span>
            </span>
          </li>
        </ul>
      </div>
    </div>
    <div th:replace="~{/layout/pagination :: pagination}"></div>
  </main>
</div>
<div th:replace="~{/layout/common-script :: common-script}"></div>
<script>
  const todoList = document.querySelectorAll('li.todo-list-item');
  todoList.forEach(item => {
    item.onclick = (e) => {
      e.stopPropagation();
      if (item.classList.contains('active')) {
        item.classList.remove('active');
      } else {
        todoList.forEach(i => i.classList.remove('active'));
        item.classList.add('active');
      }
    }

    item.querySelectorAll('button').forEach(button => {
      button.onclick = (e) => {
        e.stopPropagation();
      }
    });
  });

  document.querySelectorAll('input.mdl-textfield__input').forEach(input => {
    input.onclick = (e) => {
      e.stopPropagation();
    };

    input.onchange = (e) => {

    };
  });

  document.onclick = (e) => {
    e.stopPropagation();
    todoList.forEach(item => {
      item.classList.remove('active');
    });
  }
</script>
</body>
</html>
